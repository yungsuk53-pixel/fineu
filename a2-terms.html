<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FINE U - ê¸ˆìœµ ìš©ì–´</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .level-badge-nav {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 12px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10;
        }
        
        .level-black { background: linear-gradient(135deg, #374151, #111827); }

        .bottom-navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #e5e7eb;
            padding: 12px 0 8px 0;
            z-index: 50;
        }

        .nav-container {
            max-width: 28rem;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr 1fr;
            align-items: end;
            position: relative;
            height: 60px;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 4px;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .nav-item i {
            font-size: 20px;
        }

        .nav-item span {
            font-size: 11px;
            font-weight: 500;
        }

        .nav-item.active i {
            color: #3B82F6;
        }

        .nav-item.active span {
            color: #3B82F6;
        }

        .nav-center {
            grid-column: 3;
            display: flex;
            justify-content: center;
            align-items: end;
            height: 100%;
            position: relative;
        }

        .term-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .term-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .term-card.completed {
            opacity: 0.7;
            background: #F9FAFB;
        }

        .term-card.today {
            border-left: 4px solid #F59E0B;
            background: linear-gradient(to right, #FEF3C7, #FFFFFF);
        }

        .star-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            color: #FCD34D;
            font-size: 24px;
        }

        .star-icon.completed {
            color: #D1D5DB;
        }

        .news-badge {
            display: inline-block;
            padding: 2px 8px;
            background: #DBEAFE;
            color: #2563EB;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            margin-top: 8px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            max-width: 400px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            padding: 24px;
        }

        .complete-btn {
            background: linear-gradient(135deg, #3B82F6, #2563EB);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            width: 100%;
            transition: all 0.3s ease;
        }

        .complete-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .complete-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

<div class="min-h-screen bg-gray-100">
    <!-- ìƒë‹¨ í—¤ë” -->
    <div class="bg-white shadow-sm p-4">
        <div class="flex items-center justify-between max-w-md mx-auto">
            <button onclick="location.href='a2.html'" class="text-gray-600">
                <i class="fas fa-arrow-left text-xl"></i>
            </button>
            <div class="text-center">
                <h1 class="text-xl font-bold">ê¸ˆìœµ ìš©ì–´</h1>
                <p class="text-xs text-gray-500" id="updateInfo">ë¡œë”© ì¤‘...</p>
            </div>
            <button onclick="location.href='index.html'" class="text-gray-600">
                <i class="fas fa-calendar-alt text-xl"></i>
            </button>
        </div>
    </div>

    <!-- ìš©ì–´ ì½˜í…ì¸  -->
    <div class="max-w-md mx-auto px-4 py-6 mb-24" id="termsContainer">
        <div class="text-center py-8">
            <div class="loading-spinner mx-auto mb-2"></div>
            <p class="text-gray-500">ì˜¤ëŠ˜ì˜ ìš©ì–´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
    </div>

    <!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <div class="bottom-navigation">
        <div class="nav-container">
            <button onclick="location.href='index.html'" class="nav-item">
                <i class="fas fa-home text-gray-400"></i>
                <span class="text-gray-400">í™ˆ</span>
            </button>
            <button onclick="location.href='a2.html'" class="nav-item active">
                <i class="fas fa-newspaper"></i>
                <span>ë‰´ìŠ¤</span>
            </button>
            <div class="nav-center">
                <div class="level-badge-nav level-black">
                    BLACK
                </div>
            </div>
            <button onclick="location.href='a4.html'" class="nav-item">
                <i class="fas fa-gamepad text-gray-400"></i>
                <span class="text-gray-400">ê²Œì„</span>
            </button>
            <button onclick="location.href='a3.html'" class="nav-item">
                <i class="fas fa-ellipsis-h text-gray-400"></i>
                <span class="text-gray-400">ë”ë³´ê¸°</span>
            </button>
        </div>
    </div>
</div>

<!-- ìš©ì–´ ìƒì„¸ ëª¨ë‹¬ -->
<div id="termModal" class="modal">
    <div class="modal-content">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold" id="modalTitle">ê¸ˆìœµ ìš©ì–´</h3>
            <button onclick="closeTermModal()" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        
        <div class="mb-6">
            <h4 class="text-2xl font-bold text-gray-800 mb-2" id="termName">ìš©ì–´</h4>
            <p class="text-gray-600 mb-4" id="termDefinition">ì •ì˜</p>
            
            <div class="bg-blue-50 rounded-lg p-4 mb-4">
                <h5 class="font-semibold mb-2">ğŸ’¡ ì˜ˆì‹œ</h5>
                <p class="text-sm text-gray-700" id="termExample">ì˜ˆì‹œ ì„¤ëª…</p>
            </div>
            
            <div class="bg-gray-50 rounded-lg p-4">
                <h5 class="font-semibold mb-2">ğŸ“° ê´€ë ¨ ë‰´ìŠ¤</h5>
                <p class="text-sm text-gray-700" id="relatedNews">ê´€ë ¨ ë‰´ìŠ¤</p>
            </div>
        </div>

        <button onclick="completeTerm()" class="complete-btn" id="completeBtn">
            <i class="fas fa-check mr-2"></i>
            í•™ìŠµ ì™„ë£Œ (+50 EXP)
        </button>
    </div>
</div>

<script>
let termsData = [];
let currentTermId = null;

// ì˜¤ëŠ˜ ë‚ ì§œ ê°€ì ¸ì˜¤ê¸°
function getTodayDate() {
    return new Date().toLocaleDateString('ko-KR');
}

// ì˜¤ëŠ˜ì˜ ìš©ì–´ ë°ì´í„° ë¡œë“œ
async function loadTermsData() {
    const today = getTodayDate();
    const savedData = localStorage.getItem('todayFinancialData');
    
    if (!savedData) {
        // ë©”ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (ë°ì´í„° ìƒì„± í•„ìš”)
        alert('ì˜¤ëŠ˜ì˜ ë°ì´í„°ë¥¼ ë¨¼ì € ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.');
        location.href = 'a2.html';
        return;
    }
    
    const data = JSON.parse(savedData);
    termsData = data.terms || [];
    
    // ì™„ë£Œ ìƒíƒœ ë¡œë“œ
    const completedTerms = JSON.parse(localStorage.getItem('completedTerms') || '{}');
    const todayCompleted = completedTerms[today] || [];
    
    termsData.forEach(term => {
        term.completed = todayCompleted.includes(term.id);
    });
    
    displayTerms();
    updateInfo(data.generatedAt);
}

// ìš©ì–´ í‘œì‹œ
function displayTerms() {
    const container = document.getElementById('termsContainer');
    let html = '';
    
    // ì˜¤ëŠ˜ì˜ ê¸ˆìœµ ìš©ì–´ (ì²« ë²ˆì§¸)
    const todayTerm = termsData.find(t => t.isToday) || termsData[0];
    if (todayTerm) {
        html += `
            <div class="term-card today ${todayTerm.completed ? 'completed' : ''}" 
                 onclick="showTermDetail('${todayTerm.id}')">
                <i class="fas fa-star star-icon ${todayTerm.completed ? 'completed' : ''}"></i>
                <h3 class="text-lg font-bold mb-2">ì˜¤ëŠ˜ì˜ ê¸ˆìœµ ìš©ì–´</h3>
                <p class="text-gray-700 font-semibold">${todayTerm.term}</p>
                <p class="text-sm text-gray-600 mt-2">ì˜¤ëŠ˜ ê¼­ í•™ìŠµí•´ì•¼ í•  í•µì‹¬ ìš©ì–´</p>
            </div>
        `;
    }
    
    // ê¸ˆìœµ ìš©ì–´ ë³µìŠµí•˜ê¸°
    html += `
        <div class="term-card" onclick="showReviewTerms()">
            <h3 class="text-lg font-bold mb-2">ê¸ˆìœµ ìš©ì–´ ë³µìŠµí•˜ê¸°</h3>
            <p class="text-gray-600 text-sm">ì˜¤ëŠ˜ ë‰´ìŠ¤ì—ì„œ ë°œê²¬ëœ ${termsData.length}ê°œ ìš©ì–´</p>
        </div>
    `;
    
    // ì¶”ê°€ ìš©ì–´ë“¤
    termsData.slice(1).forEach(term => {
        if (!term.isToday) {
            html += `
                <div class="term-card ${term.completed ? 'completed' : ''}" 
                     onclick="showTermDetail('${term.id}')">
                    ${!term.completed ? '<i class="fas fa-star star-icon"></i>' : '<i class="fas fa-star star-icon completed"></i>'}
                    <h4 class="font-bold mb-1">${term.term}</h4>
                    <p class="text-sm text-gray-600">${term.definition.substring(0, 50)}...</p>
                    <span class="news-badge">ë‰´ìŠ¤ ì—°ê´€</span>
                </div>
            `;
        }
    });
    
    container.innerHTML = html;
}

// ì—…ë°ì´íŠ¸ ì •ë³´ í‘œì‹œ
function updateInfo(generatedAt) {
    const updateTime = new Date(generatedAt);
    document.getElementById('updateInfo').textContent = 
        `${updateTime.toLocaleDateString('ko-KR')} ${updateTime.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'})} ìƒì„±`;
}

// ìš©ì–´ ìƒì„¸ ë³´ê¸°
function showTermDetail(termId) {
    const term = termsData.find(t => t.id === termId);
    if (!term) return;
    
    currentTermId = termId;
    
    document.getElementById('modalTitle').textContent = term.isToday ? 'ì˜¤ëŠ˜ì˜ ê¸ˆìœµ ìš©ì–´' : 'ê¸ˆìœµ ìš©ì–´';
    document.getElementById('termName').textContent = term.term;
    document.getElementById('termDefinition').textContent = term.definition;
    document.getElementById('termExample').textContent = term.example;
    document.getElementById('relatedNews').textContent = term.relatedNews || 'ì˜¤ëŠ˜ì˜ ê²½ì œ ë‰´ìŠ¤ì™€ ê´€ë ¨ëœ ìš©ì–´ì…ë‹ˆë‹¤.';
    
    // ì™„ë£Œ ë²„íŠ¼ ìƒíƒœ
    if (term.completed) {
        document.getElementById('completeBtn').textContent = 'ì´ë¯¸ ì™„ë£Œí•¨';
        document.getElementById('completeBtn').disabled = true;
    } else {
        const exp = term.isToday ? 100 : 50;
        document.getElementById('completeBtn').textContent = `í•™ìŠµ ì™„ë£Œ (+${exp} EXP)`;
        document.getElementById('completeBtn').disabled = false;
    }
    
    document.getElementById('termModal').classList.add('show');
}

// ë³µìŠµ ìš©ì–´ ë³´ê¸°
function showReviewTerms() {
    let reviewList = 'ğŸ“š ì˜¤ëŠ˜ì˜ ê¸ˆìœµ ìš©ì–´ ëª©ë¡\n\n';
    
    termsData.forEach((term, index) => {
        const status = term.completed ? 'âœ…' : 'â­';
        reviewList += `${status} ${index + 1}. ${term.term}\n`;
    });
    
    reviewList += '\ní•™ìŠµí•˜ì§€ ì•Šì€ ìš©ì–´ë¥¼ í´ë¦­í•˜ì—¬ í•™ìŠµí•˜ì„¸ìš”!';
    alert(reviewList);
}

// ëª¨ë‹¬ ë‹«ê¸°
function closeTermModal() {
    document.getElementById('termModal').classList.remove('show');
    currentTermId = null;
}

// í•™ìŠµ ì™„ë£Œ
function completeTerm() {
    if (!currentTermId) return;
    
    const term = termsData.find(t => t.id === currentTermId);
    if (!term || term.completed) return;
    
    const today = getTodayDate();
    
    // ì™„ë£Œ ìƒíƒœ ì €ì¥
    const completedTerms = JSON.parse(localStorage.getItem('completedTerms') || '{}');
    if (!completedTerms[today]) {
        completedTerms[today] = [];
    }
    completedTerms[today].push(currentTermId);
    localStorage.setItem('completedTerms', JSON.stringify(completedTerms));
    
    // ê²½í—˜ì¹˜ ì¶”ê°€
    const exp = term.isToday ? 100 : 50;
    let userExp = parseInt(localStorage.getItem('userExp') || 0);
    userExp += exp;
    localStorage.setItem('userExp', userExp);
    
    // UI ì—…ë°ì´íŠ¸
    term.completed = true;
    displayTerms();
    
    alert(`${term.term} í•™ìŠµì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! (+${exp} EXP)`);
    closeTermModal();
}

// í˜ì´ì§€ ë¡œë“œì‹œ ì‹¤í–‰
document.addEventListener('DOMContentLoaded', function() {
    loadTermsData();
});

// ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ì‹œ ë‹«ê¸°
document.addEventListener('click', function(e) {
    const modal = document.getElementById('termModal');
    if (e.target === modal) {
        closeTermModal();
    }
});
</script>

</body>
</html>
